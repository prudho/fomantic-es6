<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Fomantic - Visibility</title>
  <link rel="stylesheet" href="./styles.css">
  <script src="../dist/fomantic.umd.js"></script>
  <script src="./legacy/jquery-3.6.0.min.js"></script>
</head>
<body style="padding: 1rem;">
  
  <div class="first visibility example">
    <div class="two column equal height ui grid">
      <div class="row">
        <div id="firstColumn" class="main column">
          <div id="firstSegment" class="ui first demo segment">
            <img src="./images/wireframe/centered-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/short-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/media-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/centered-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/short-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/media-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/short-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/centered-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/short-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/media-paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/paragraph.png" class="ui wireframe image">
            <div class="ui divider"></div>
            <img src="./images/wireframe/short-paragraph.png" class="ui wireframe image">
          </div>
        </div>
        <div class="column">
          <div id="sticky" class="ui visible sticky">
            <table class="ui basic celled sortable two column table">
              <thead>
                <th>Calculation</th>
                <th>Value</th>
              </thead>
              <tbody>
                <tr class="pixelsPassed">
                  <td>pixelsPassed</td>
                  <td></td>
                </tr>
                <tr class="percentagePassed">
                  <td>percentagePassed</td>
                  <td></td>
                </tr>
                <tr class="fits">
                  <td>fits</td>
                  <td></td>
                </tr>
                <tr class="width">
                  <td>width</td>
                  <td></td>
                </tr>
                <tr class="height">
                  <td>height</td>
                  <td></td>
                </tr>
                <tr class="onScreen">
                  <td>onScreen</td>
                  <td></td>
                </tr>
                <tr class="offScreen">
                  <td>offScreen</td>
                  <td></td>
                </tr>
                <tr class="passing">
                  <td>passing</td>
                  <td></td>
                </tr>
                <tr class="topVisible">
                  <td>topVisible</td>
                  <td></td>
                </tr>
                <tr class="bottomVisible">
                  <td>bottomVisible</td>
                  <td></td>
                </tr>
                <tr class="topPassed">
                  <td>topPassed</td>
                  <td></td>
                </tr>
                <tr class="bottomPassed">
                  <td>bottomPassed</td>
                  <td></td>
                </tr>
              </tr>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', () => {
      const sticky = new fomantic.Sticky('#sticky', {
        observeChanges : false,
        pushing        : true,
        context        : '#firstColumn',
        offset         : 60
      });

      const visibility = new fomantic.Visibility('#firstSegment', {
        debug: true,
        verbose: true,
        once           : false,
        continuous     : true,
        observeChanges : false,
        onUpdate       : function(calculations) {
          $.each(calculations, function(name, value = '') {
            var
              value = (typeof value == 'integer')
                ? parseInt(value, 10)
                : value.toString(),
              $td
            ;
            if(name == 'pixelsPassed' || name == 'width' || name == 'height') {
              value = parseInt(value, 10) + 'px';
            }
            else if(name == 'percentagePassed') {
              value = parseInt(value * 100, 10) + '%';
            }
            $td = $('.first.example .grid .sticky tr.'+ name +' td:last-child');
            if($td.html() !== value) {
              if(value == 'true' || value == 'false') {
                $td.removeClass('highlight').addClass('highlight');
                setTimeout(function(){ $td.removeClass('highlight'); }, 2000);
              }
              $td.html(value);
            }
          });
        }
      });
    });
  </script>
</body>